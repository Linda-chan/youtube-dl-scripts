<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
                      "http://www.w3c.org/TR/REC-html40/strict.dtd">
<html lang="ru">
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="Линда Кайе 2017. Посвящается Ариэль" name="Author">
    <meta content="AJPapps - Spawn HTML file" name="Generator">
    <meta content="ANPFile" name="ProgId">
    <meta content="width=device-width, initial-scale=1" name="Viewport">
    <meta content="---" name="Description">
    
    <title>Yay! (C)</title>
    
    <style type="text/css">
    <!--
      body {font:12pt "Trebuchet MS",Tahoma,Arial,sans-serif;}
      pre {font:12pt Consolas,"Courier New",monospace;}
      img {border:none;}
    -->
    </style>
  </head>
  <body>
    
<h1>youtube-dl Scripts</h1>

<p>Эти скрипты предназначены для запуска <a href="http://youtube-dl.org">youtube-dl</a> с некоторыми полезными параметрами. Разделение идёт по качеству запрашиваемого видео и использованию прокси.</p>

<p>Все скрипты представлены в двух версиях: BAT файлы для Windows и скрипты для Bash (Linux и тому подобное). В основном они идентичны, но Windows версия ориентирована на портабельность. Вот несколько отличий:</p>

<ul>
<li><p>Windows версия ищет файл youtube-dl.exe в каталоге с BAT файлом, в то время как Linux версия считает, что youtube-dl установлен где-то в системе.</p></li>
<li><p>Windows версия ищет <a href="https://ffmpeg.zeranoe.com/builds/win32/static/">ffmpeg</a> в каталоге с BAT файлом (точнее, «ffmpeg\bin»), в то время как Linux версия считает, что ffmpeg установлен где-то в системе.</p></li>
<li><p>Windows версия ищет <a href="http://atomicparsley.sourceforge.net">AtomicParsley</a> в каталоге с BAT файлом (точнее, «AtomicParsley»), в то время как Linux версия считает, что AtomicParsley установлен где-то в системе.</p></li>
</ul>


<p>При запуске скрипта переменная HOME переписывается каталогом скрипта. Таким образом файл «<a href="https://github.com/rg3/youtube-dl#authentication-with-netrc-file">.netrc</a>» (с логинами и паролями) берётся из каталога скрипта. То же относится и к каталогу «.cache», который создаётся при скачке видео с YouTube – для его размещения переписывается переменная XDG_CACHE_HOME.</p>

<p>Обратите внимание, что Linux версия скрипта использует команду readlink для получения каталога скрипта. Таким образом использование симлинков на файлы скриптом становится невозможным – скрипт всегда будет устанавливать в HOME каталог оригинального файла, а не симлинка. В Windows такой проблемы нет.</p>

<h2>Прокси</h2>

<p>Настройки прокси берутся из системы. В Windows это – настройки Internet Explorer («Свойства обозревателя» или что-то такое в Панели управления), в Linux – переменная HTTP_PROXY. Если в системе прокси не определён, то соединение производится напрямую.</p>

<h2>Пользовательский конфиг</h2>

<p>При запуске скрипт ищет файл «youtube-dl.cfg» в каталоге скрипта. Если такой файл обнаруживается, он назначается конфигом для youtube-dl. Из него программа берёт дополнительные параметры как если бы они были переданы через командную строку.</p>

<p>Например, его содержимое может быть таким:</p>

<pre><code>--write-description
--write-info-json
--write-annotations
</code></pre>

<p><strong>Внимание!</strong> На данный момент пользовательский конфиг поддерживается только в Windows.</p>

<h2>Формат имени файла скрипта</h2>

<p>Имя файла скрипта выглядит примерно так:</p>

<blockquote><p>youtube-dl-XX-YY.ZZ</p></blockquote>

<p>Где:</p>

<ul>
<li><p>XX – вариант прокси:</p>

<ul>
<li><strong>np</strong> – прямое соединение.</li>
<li><strong>prx</strong> – системный прокси.</li>
</ul>
</li>
<li><p>YY – качество видео (можно воспринимать как «степень сжатия»):</p>

<ul>
<li><strong>c0</strong> – лучшее.</li>
<li><strong>c5</strong> – среднее (YouTube, см. ниже).</li>
<li><strong>c9</strong> – худшее.</li>
<li><strong>cZ</strong> – определяется пользователем (см. ниже).</li>
<li><strong>ytcombo</strong> – такой вариант скрипта вызывает другие (за исключением «audio»), пытаясь скачать видео во всех трёх вариантах качества от худшего до лучшего. Применяется для YouTube.</li>
<li><strong>audio</strong> – извлечение аудио. Программа попытается скачать аудиофайл лучшего качества, а если это не получится, то видеофайл со звуковой дорожкой лучшего качества. В итоговый файл данные конвертируются при помощи ffmpeg. Если он отсутствует, программа оставит то, что прислал сервер.</li>
<li><strong>formats</strong> – такой вариант скрипта просто показывает список доступных для скачки форматов, ни чего не качая.</li>
<li><strong>update</strong> – особый случай. Этот файл ничего не качает, а просто пытается обновить youtube-dl до последней версии и создаёт файл youtube-dl.txt со справкой по параметрам программы.</li>
</ul>
</li>
<li><p>ZZ – расширение:</p>

<ul>
<li><strong>bat</strong> – Windows BAT файл.</li>
<li><strong>sh</strong> – Bash скрипт.</li>
</ul>
</li>
</ul>


<p>Например:</p>

<blockquote><p>youtube-dl-prx-c9.bat</p></blockquote>

<p>BAT файл для Windows, качающий видео худшего качества через прокси.</p>

<h2>Качество видео</h2>

<h3 id="c0">c0</h3>

<p>youtube-dl автоматически выбирает лучшее качество из того, что предложит сервер. На YouTube обычно это – MP4. На других серверах может быть по-разному.</p>

<h3 id="c5">c5</h3>

<p>Этот вариант работает только с YouTube и основывается на предположении, что видео лучшего качества отдаётся в MP4, худшего – в 3gp, а среднего – в Webm. Таким образом скрипт запрашивает не определённое качество, а формат – Webm, который, как предполагается, и содержит видео среднего качества.</p>

<p><strong>Внимание!</strong> То и дело мне попадаются ролики, у которых вариант с лучшим качеством отдаётся не в MP4, а в Webm, так что будьте бдительны!</p>

<h3 id="c9">c9</h3>

<p>youtube-dl автоматически выбирает худшее качество из того, что предложит сервер. На YouTube обычно это – 3gp (для старых мобильных телефонов). На других серверах может быть по-разному.</p>

<p><strong>Внимание!</strong> На серверах отличных от YouTube худшего качества может не быть (ролик может быть в одном варианте вообще), и youtube-dl скачает то, что есть. Тем, что есть может оказаться то же видео в HD качестве.</p>

<p>Так же на серверах отличных от YouTube худшее качество может быть в том же формате, что и лучшее, например, в MP4. Поэтому файлы обоих вариантов будут иметь одинаковое имя.</p>

<p>Будьте бдительны!</p>

<h3 id="cZ">cZ</h3>

<p>В этом варианте формат видео выбирает сам пользователь. Его нужно передать первым аргументом скрипта в виде кода формата, который можно подсмотреть в первой колонке («Format code») таблички, которую показывает <strong>formats</strong> версия скриптов.</p>

<p>Так же можно указать общие значения, такие как «best», «worst», «mp4», «bestaudio/best» и так далее. Подробности смотрите в документации к youtube-dl, параметр «&ndash;format».</p>

<p>Указанный пользователям формат применяется ко всем URL в командной строке. Если такого формата для очередного видео не окажется, youtube-dl пропустит его и перейдёт к следующему URL.</p>

<h2>История изменений</h2>

<ul>
<li><p>23.07.2017</p>

<ul>
<li>[+] В подсказку по использованию добавлен пример с ключами «-a» и «&ndash;batch-file». Сама поддержка уже была в скриптах по причине передачи всех парметров BAT и sh файлов программе.</li>
<li>[+] Теперь появился нормальный ченджлог. Предыдущие изменения можно выяснить разве что только из истории коммитов.</li>
</ul>
</li>
<li><p>27.08.2017</p>

<ul>
<li>[+] Появилась поддержка пользовательского конфига в Windows.</li>
</ul>
</li>
</ul>


<h2>Маленький копирайт</h2>

<ol>
<li><p>Программа и исходный код распространяются бесплатно.</p></li>
<li><p>Вы имеете право распространять их на тех же условиях.</p></li>
<li><p>Вы не имеете права использовать имя автора после модификации исходного кода.</p></li>
<li><p>При этом желательно указывать ссылку на автора оригинальной версии исходного кода.</p></li>
<li><p>Вы не имеете права на платное распространение исходного кода, а также программных модулей, содержащих данный исходнй код.</p></li>
<li><p>Программа и исходный код распространяются как есть. Автор не несёт ответственности за любые трагедии или несчастные случаи, вызванные использованием программы и исходного кода.</p></li>
<li><p>Для любого пункта данного соглашения может быть сделано исключение с разрешения автора программы.</p></li>
<li><p>По любым вопросам, связанным с данной программой, обращайтесь по адресу <a href="&#x6d;&#x61;&#105;&#x6c;&#116;&#111;&#58;&#x6c;&#105;&#x6e;&#x64;&#97;&#111;&#x6e;&#101;&#x65;&#115;&#x61;&#x6d;&#97;&#x40;&#103;&#x6d;&#97;&#x69;&#108;&#x2e;&#99;&#x6f;&#x6d;">&#x6c;&#105;&#x6e;&#x64;&#97;&#111;&#110;&#x65;&#x65;&#x73;&#97;&#109;&#97;&#x40;&#103;&#x6d;&#x61;&#x69;&#108;&#x2e;&#99;&#111;&#x6d;</a></p></li>
</ol>
    
  </body>
</html>
